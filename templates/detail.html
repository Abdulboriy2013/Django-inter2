{% extends "_base.html" %} {% block content %}

<style>
  body {
    background: #0f172a;
  }

  .card {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.08);
  }

  .comment-card {
    background: rgba(255, 255, 255, 0.04);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.06);
  }

  input:focus {
    border-color: #22d3ee;
    box-shadow: 0 0 8px rgba(34, 211, 238, 0.5);
  }
</style>
<a href="{% url 'like_post' maqola.id %}"
  >{{likes_count}}<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      fill="currentColor"
      d="M23 10a2 2 0 0 0-2-2h-6.32l.96-4.57c.02-.1.03-.21.03-.32c0-.41-.17-.79-.44-1.06L14.17 1L7.59 7.58C7.22 7.95 7 8.45 7 9v10a2 2 0 0 0 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73zM1 21h4V9H1z"
    /></svg
></a>

<h3>views: {{maqola.views}}</h3>
<div class="container mx-auto px-6 py-16 max-w-4xl text-white">
  <!-- BLOG POST -->
  <div class="card p-8 mb-12">
    <h2 class="text-sm text-gray-400 mb-2">Ko'rishlar: {{ maqola.views }}</h2>

    <h1 class="text-3xl font-bold mb-6 text-cyan-400">{{ maqola.title }}</h1>

    <div class="text-gray-300 leading-relaxed">{{ maqola.content|safe }}</div>
  </div>

  <!-- COMMENTS -->
  <div>
    <h2 class="text-gray-900 text-3xl font-bolt font-manrope leading-normal">
      {{comments_count}} comments
    </h2>
    <h2 class="text-xl text-cyan-400 mb-6">Comments</h2>

    <!-- COMMENT INPUT -->
    <form action="{% url 'comment' %}" method="post" class="mb-8">
      <input type="hidden" name="maqolaId" value="{{ maqola.id }}" />
      {% csrf_token %} {% if request.user.is_authenticated %}
      <div class="flex gap-3">
        <input
          type="text"
          name="comment"
          placeholder="Write a comment..."
          class="flex-1 p-3 rounded-lg bg-gray-800 text-white border border-gray-700 outline-none"
          required
          name="comment"
        />
        <button
          type="submit"
          class="px-5 py-3 rounded-lg bg-cyan-400 text-black font-medium hover:bg-cyan-300 transition"
        >
          Send
        </button>
      </div>
      {% else %}
      <div class="flex gap-3">
        <input
          type="text"
          name="comment"
          placeholder="Write a comment..."
          disabled
          class="flex-1 p-3 rounded-lg bg-gray-800 text-white border border-gray-700 outline-none"
          required
        />
        <button
          type="submit"
          class="px-5 py-3 rounded-lg bg-cyan-400 text-black font-medium hover:bg-cyan-300 transition"
        >
          Send
        </button>
      </div>
      {% endif %}
    </form>

    <!-- COMMENTS LOOP -->
    {% for comment in comments %}
    <div class="comment-card p-5 mb-4">
      <div class="flex justify-between mb-2 text-sm text-gray-400">
        <span class="text-cyan-300 font-medium"> {{ comment.user }} </span>
        <span>{{ comment.vaqti }}</span>
      </div>

      <p class="text-gray-300 mb-3">{{ comment.comment }}</p>

      {% if comment.adminReply %}
      <div class="pl-4 border-l-2 border-cyan-400 text-sm text-gray-300">
        <span class="text-cyan-300 font-medium">Admin:</span>
        {{ comment.adminReply }}
      </div>
      {% endif %}
    </div>
    {% endfor %}
  </div>
</div>

{% endblock content %}
